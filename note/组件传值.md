# 组件传值


## 01. 父组件向子组件

### 01.1. props
在 vue2 中
```html
<template>
  <child :msg="msg"></child>
</template>
```
```js
export default {
  props:['msg'];
}
```

在 vue3 下
```html
<child :msg="msg"></child>
<script>
  import {ref, reactive} from 'vue';
  const msg = ref('传递给子组件的信息');
</script>
```
```js
const props = defineProps({
  msg: String;
})
```



## 02.子组件向父组件
### 02.1. $emit
在 vue2 下
```html
<template>
  <child @sendMsg="getChildMsg"></child>
</template>
<script>
  export default {
    methods: {
      getChildMsg(msg) {
        console.log(msg)
      }
    }
  }
</script>
```
```js
export default {
  data() {
    return {msg: "发给父组件的信息"}
  }
  methods: {
    handlerClick() {
      this.$emit('sendMsg', this.msg)
    }
  }
}
```

在 vue3 下
```html
<template>
    <child @myClick="onMyClick"></child>
</template>
<script setup>
    import child from "./child.vue"
    const onMyClick = (msg) => {
        console.log(msg) // 这是父组件收到的信息
    }
</script>
```
```html
<template>
    // 写法一
    <button @click="emit('myClick')">按钮</buttom>
    // 写法二
    <button @click="handleClick">按钮</buttom>
</template>
<script setup>
    
    // 方法一 适用于Vue3.2版本 不需要引入
    // import { defineEmits } from "vue"
    // 对应写法一
    const emit = defineEmits(["myClick","myClick2"])
    // 对应写法二
    const handleClick = ()=>{
        emit("myClick", "这是发送给父组件的信息")
    }
    
    // 方法二 不适用于 Vue3.2版本，该版本 useContext()已废弃
    import { useContext } from "vue"
    const { emit } = useContext()
    const handleClick = ()=>{
        emit("myClick", "这是发送给父组件的信息")
    }
</script>
```



## 03. 同级传值
### 03.1. EventBus
```js
// 方法一
// 抽离成一个单独的 js 文件 Bus.js ，然后在需要的地方引入
// Bus.js
import Vue from "vue"
export default new Vue()

// 方法二 直接挂载到全局
// main.js
import Vue from "vue"
Vue.prototype.$bus = new Vue()

// 方法三 注入到 Vue 根对象上
// main.js
import Vue from "vue"
new Vue({
    el:"#app",
    data:{
        Bus: new Vue()
    }
})
```
```js
// 在需要向外部发送自定义事件的组件内
<template>
    <button @click="handlerClick">按钮</button>
</template>
import Bus from "./Bus.js"
export default{
    methods:{
        handlerClick(){
            // 自定义事件名 sendMsg
            Bus.$emit("sendMsg", "这是要向外部发送的数据")
        }
    }
}

// 在需要接收外部事件的组件内
import Bus from "./Bus.js"
export default{
    mounted(){
        // 监听事件的触发
        Bus.$on("sendMsg", data => {
            console.log("这是接收到的数据：", data)
        })
    },
    beforeDestroy(){
        // 取消监听
        Bus.$off("sendMsg")
    }
}
```